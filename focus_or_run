#! /bin/dash

while [ $# -gt 0 ] ; do
    arg=""
    cmd=""
    trm=1
    case "$1" in
        browser)
            cmd=$BROWSER
            trm=0
            ;;
        *)
            case "$1" in
                mutt|ncmpcpp|top)
                    cmd=$1
                    ;;
                bspwmrc|sxhkdrc)
                    arg="${XDG_DOTFILES_DIR}/$1"
                    ;;
                *)
                    arg="${XDG_DATA_HOME}/$1"
                    ;;
            esac
            [ -n "$cmd" ] && cmd="termite -e \"$cmd\""
            ;;
    esac
    wid=""
    if [ $trm -eq 0 ] ; then
        wid=$(xdo id -n $cmd $(bspc query -W) | tail -n 1)
    else
        ppid=$(pgrep -nf "${cmd:-"$arg"}")
        [ -n "$ppid" ] && wid=$(xdo id -p $ppid $(bspc query -W) | tail -n 1)
    fi
    if [ -n "$wid" ] ; then
        bspc window "$wid" -f
    else
        if [ -n "$cmd" ] ; then
            fork $cmd
        else
            fork termite -e "editor '$arg'"
        fi
    fi
    shift
done
